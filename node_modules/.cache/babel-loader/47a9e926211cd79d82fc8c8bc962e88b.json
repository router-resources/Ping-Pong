{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.defineProperties = void 0;\nvar assert_1 = __importDefault(require(\"assert\"));\nvar internal_1 = require(\"./internal\");\nvar externals_1 = require(\"./externals\");\nvar bytes_1 = require(\"./bytes\");\n/**\n * Defines properties on a `Object`. It make the assumption that underlying data is binary.\n * @param self the `Object` to define properties on\n * @param fields an array fields to define. Fields can contain:\n * * `name` - the name of the properties\n * * `length` - the number of bytes the field can have\n * * `allowLess` - if the field can be less than the length\n * * `allowEmpty`\n * @param data data to be validated against the definitions\n * @deprecated\n */\nvar defineProperties = function (self, fields, data) {\n  self.raw = [];\n  self._fields = [];\n  // attach the `toJSON`\n  self.toJSON = function (label) {\n    if (label === void 0) {\n      label = false;\n    }\n    if (label) {\n      var obj_1 = {};\n      self._fields.forEach(function (field) {\n        obj_1[field] = \"0x\".concat(self[field].toString('hex'));\n      });\n      return obj_1;\n    }\n    return (0, bytes_1.baToJSON)(self.raw);\n  };\n  self.serialize = function serialize() {\n    return externals_1.rlp.encode(self.raw);\n  };\n  fields.forEach(function (field, i) {\n    self._fields.push(field.name);\n    function getter() {\n      return self.raw[i];\n    }\n    function setter(v) {\n      v = (0, bytes_1.toBuffer)(v);\n      if (v.toString('hex') === '00' && !field.allowZero) {\n        v = Buffer.allocUnsafe(0);\n      }\n      if (field.allowLess && field.length) {\n        v = (0, bytes_1.unpadBuffer)(v);\n        (0, assert_1.default)(field.length >= v.length, \"The field \".concat(field.name, \" must not have more \").concat(field.length, \" bytes\"));\n      } else if (!(field.allowZero && v.length === 0) && field.length) {\n        (0, assert_1.default)(field.length === v.length, \"The field \".concat(field.name, \" must have byte length of \").concat(field.length));\n      }\n      self.raw[i] = v;\n    }\n    Object.defineProperty(self, field.name, {\n      enumerable: true,\n      configurable: true,\n      get: getter,\n      set: setter\n    });\n    if (field.default) {\n      self[field.name] = field.default;\n    }\n    // attach alias\n    if (field.alias) {\n      Object.defineProperty(self, field.alias, {\n        enumerable: false,\n        configurable: true,\n        set: setter,\n        get: getter\n      });\n    }\n  });\n  // if the constuctor is passed data\n  if (data) {\n    if (typeof data === 'string') {\n      data = Buffer.from((0, internal_1.stripHexPrefix)(data), 'hex');\n    }\n    if (Buffer.isBuffer(data)) {\n      data = externals_1.rlp.decode(data);\n    }\n    if (Array.isArray(data)) {\n      if (data.length > self._fields.length) {\n        throw new Error('wrong number of fields in data');\n      }\n      // make sure all the items are buffers\n      data.forEach(function (d, i) {\n        self[self._fields[i]] = (0, bytes_1.toBuffer)(d);\n      });\n    } else if (typeof data === 'object') {\n      var keys_1 = Object.keys(data);\n      fields.forEach(function (field) {\n        if (keys_1.indexOf(field.name) !== -1) self[field.name] = data[field.name];\n        if (keys_1.indexOf(field.alias) !== -1) self[field.alias] = data[field.alias];\n      });\n    } else {\n      throw new Error('invalid data');\n    }\n  }\n};\nexports.defineProperties = defineProperties;","map":{"version":3,"mappings":"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","names":["defineProperties","self","fields","data","raw","_fields","toJSON","label","obj_1","forEach","field","toString","serialize","externals_1","encode","i","push","name","getter","setter","v","allowZero","Buffer","allocUnsafe","allowLess","length","Object","defineProperty","enumerable","configurable","get","set","default","alias","from","isBuffer","decode","Array","isArray","Error","d","keys_1","keys","indexOf","exports"],"sourceRoot":"","sources":["../src/object.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}