{"ast":null,"code":"/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file batch.js\n * @author Marek Kotewicz <marek@ethdev.com>\n * @date 2015\n */\n\"use strict\";\n\nvar Jsonrpc = require('./jsonrpc');\nvar errors = require('web3-core-helpers').errors;\nvar Batch = function (requestManager) {\n  this.requestManager = requestManager;\n  this.requests = [];\n};\n/**\n * Should be called to add create new request to batch request\n *\n * @method add\n * @param {Object} jsonrpc requet object\n */\nBatch.prototype.add = function (request) {\n  this.requests.push(request);\n};\n/**\n * Should be called to execute batch request\n *\n * @method execute\n */\nBatch.prototype.execute = function () {\n  var requests = this.requests;\n  var sortResponses = this._sortResponses.bind(this);\n  this.requestManager.sendBatch(requests, function (err, results) {\n    results = sortResponses(results);\n    requests.map(function (request, index) {\n      return results[index] || {};\n    }).forEach(function (result, index) {\n      if (requests[index].callback) {\n        if (result && result.error) {\n          return requests[index].callback(errors.ErrorResponse(result));\n        }\n        if (!Jsonrpc.isValidResponse(result)) {\n          return requests[index].callback(errors.InvalidResponse(result));\n        }\n        try {\n          requests[index].callback(null, requests[index].format ? requests[index].format(result.result) : result.result);\n        } catch (err) {\n          requests[index].callback(err);\n        }\n      }\n    });\n  });\n};\n// Sort responses\nBatch.prototype._sortResponses = function (responses) {\n  return (responses || []).sort((a, b) => a.id - b.id);\n};\nmodule.exports = Batch;","map":{"version":3,"names":["Jsonrpc","require","errors","Batch","requestManager","requests","prototype","add","request","push","execute","sortResponses","_sortResponses","bind","sendBatch","err","results","map","index","forEach","result","callback","error","ErrorResponse","isValidResponse","InvalidResponse","format","responses","sort","a","b","id","module","exports"],"sources":["/Users/shivamsoni/Desktop/router/pingspong/Ping-Pong/node_modules/web3-core-requestmanager/lib/batch.js"],"sourcesContent":["/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file batch.js\n * @author Marek Kotewicz <marek@ethdev.com>\n * @date 2015\n */\n\"use strict\";\nvar Jsonrpc = require('./jsonrpc');\nvar errors = require('web3-core-helpers').errors;\nvar Batch = function (requestManager) {\n    this.requestManager = requestManager;\n    this.requests = [];\n};\n/**\n * Should be called to add create new request to batch request\n *\n * @method add\n * @param {Object} jsonrpc requet object\n */\nBatch.prototype.add = function (request) {\n    this.requests.push(request);\n};\n/**\n * Should be called to execute batch request\n *\n * @method execute\n */\nBatch.prototype.execute = function () {\n    var requests = this.requests;\n    var sortResponses = this._sortResponses.bind(this);\n    this.requestManager.sendBatch(requests, function (err, results) {\n        results = sortResponses(results);\n        requests.map(function (request, index) {\n            return results[index] || {};\n        }).forEach(function (result, index) {\n            if (requests[index].callback) {\n                if (result && result.error) {\n                    return requests[index].callback(errors.ErrorResponse(result));\n                }\n                if (!Jsonrpc.isValidResponse(result)) {\n                    return requests[index].callback(errors.InvalidResponse(result));\n                }\n                try {\n                    requests[index].callback(null, requests[index].format ? requests[index].format(result.result) : result.result);\n                }\n                catch (err) {\n                    requests[index].callback(err);\n                }\n            }\n        });\n    });\n};\n// Sort responses\nBatch.prototype._sortResponses = function (responses) {\n    return (responses || []).sort((a, b) => a.id - b.id);\n};\nmodule.exports = Batch;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AACZ,IAAIA,OAAO,GAAGC,OAAO,CAAC,WAAW,CAAC;AAClC,IAAIC,MAAM,GAAGD,OAAO,CAAC,mBAAmB,CAAC,CAACC,MAAM;AAChD,IAAIC,KAAK,GAAG,UAAUC,cAAc,EAAE;EAClC,IAAI,CAACA,cAAc,GAAGA,cAAc;EACpC,IAAI,CAACC,QAAQ,GAAG,EAAE;AACtB,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACAF,KAAK,CAACG,SAAS,CAACC,GAAG,GAAG,UAAUC,OAAO,EAAE;EACrC,IAAI,CAACH,QAAQ,CAACI,IAAI,CAACD,OAAO,CAAC;AAC/B,CAAC;AACD;AACA;AACA;AACA;AACA;AACAL,KAAK,CAACG,SAAS,CAACI,OAAO,GAAG,YAAY;EAClC,IAAIL,QAAQ,GAAG,IAAI,CAACA,QAAQ;EAC5B,IAAIM,aAAa,GAAG,IAAI,CAACC,cAAc,CAACC,IAAI,CAAC,IAAI,CAAC;EAClD,IAAI,CAACT,cAAc,CAACU,SAAS,CAACT,QAAQ,EAAE,UAAUU,GAAG,EAAEC,OAAO,EAAE;IAC5DA,OAAO,GAAGL,aAAa,CAACK,OAAO,CAAC;IAChCX,QAAQ,CAACY,GAAG,CAAC,UAAUT,OAAO,EAAEU,KAAK,EAAE;MACnC,OAAOF,OAAO,CAACE,KAAK,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC,CAACC,OAAO,CAAC,UAAUC,MAAM,EAAEF,KAAK,EAAE;MAChC,IAAIb,QAAQ,CAACa,KAAK,CAAC,CAACG,QAAQ,EAAE;QAC1B,IAAID,MAAM,IAAIA,MAAM,CAACE,KAAK,EAAE;UACxB,OAAOjB,QAAQ,CAACa,KAAK,CAAC,CAACG,QAAQ,CAACnB,MAAM,CAACqB,aAAa,CAACH,MAAM,CAAC,CAAC;QACjE;QACA,IAAI,CAACpB,OAAO,CAACwB,eAAe,CAACJ,MAAM,CAAC,EAAE;UAClC,OAAOf,QAAQ,CAACa,KAAK,CAAC,CAACG,QAAQ,CAACnB,MAAM,CAACuB,eAAe,CAACL,MAAM,CAAC,CAAC;QACnE;QACA,IAAI;UACAf,QAAQ,CAACa,KAAK,CAAC,CAACG,QAAQ,CAAC,IAAI,EAAEhB,QAAQ,CAACa,KAAK,CAAC,CAACQ,MAAM,GAAGrB,QAAQ,CAACa,KAAK,CAAC,CAACQ,MAAM,CAACN,MAAM,CAACA,MAAM,CAAC,GAAGA,MAAM,CAACA,MAAM,CAAC;QAClH,CAAC,CACD,OAAOL,GAAG,EAAE;UACRV,QAAQ,CAACa,KAAK,CAAC,CAACG,QAAQ,CAACN,GAAG,CAAC;QACjC;MACJ;IACJ,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC;AACD;AACAZ,KAAK,CAACG,SAAS,CAACM,cAAc,GAAG,UAAUe,SAAS,EAAE;EAClD,OAAO,CAACA,SAAS,IAAI,EAAE,EAAEC,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACE,EAAE,GAAGD,CAAC,CAACC,EAAE,CAAC;AACxD,CAAC;AACDC,MAAM,CAACC,OAAO,GAAG9B,KAAK"},"metadata":{},"sourceType":"script"}