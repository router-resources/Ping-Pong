{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.defineProperties = void 0;\nvar assert = require('assert');\nvar ethjsUtil = require('ethjs-util');\nvar rlp = require(\"rlp\");\nvar bytes_1 = require(\"./bytes\");\n/**\n * Defines properties on a `Object`. It make the assumption that underlying data is binary.\n * @param self the `Object` to define properties on\n * @param fields an array fields to define. Fields can contain:\n * * `name` - the name of the properties\n * * `length` - the number of bytes the field can have\n * * `allowLess` - if the field can be less than the length\n * * `allowEmpty`\n * @param data data to be validated against the definitions\n * @deprecated\n */\nexports.defineProperties = function (self, fields, data) {\n  self.raw = [];\n  self._fields = [];\n  // attach the `toJSON`\n  self.toJSON = function (label) {\n    if (label === void 0) {\n      label = false;\n    }\n    if (label) {\n      var obj_1 = {};\n      self._fields.forEach(function (field) {\n        obj_1[field] = \"0x\" + self[field].toString('hex');\n      });\n      return obj_1;\n    }\n    return bytes_1.baToJSON(self.raw);\n  };\n  self.serialize = function serialize() {\n    return rlp.encode(self.raw);\n  };\n  fields.forEach(function (field, i) {\n    self._fields.push(field.name);\n    function getter() {\n      return self.raw[i];\n    }\n    function setter(v) {\n      v = bytes_1.toBuffer(v);\n      if (v.toString('hex') === '00' && !field.allowZero) {\n        v = Buffer.allocUnsafe(0);\n      }\n      if (field.allowLess && field.length) {\n        v = bytes_1.stripZeros(v);\n        assert(field.length >= v.length, \"The field \" + field.name + \" must not have more \" + field.length + \" bytes\");\n      } else if (!(field.allowZero && v.length === 0) && field.length) {\n        assert(field.length === v.length, \"The field \" + field.name + \" must have byte length of \" + field.length);\n      }\n      self.raw[i] = v;\n    }\n    Object.defineProperty(self, field.name, {\n      enumerable: true,\n      configurable: true,\n      get: getter,\n      set: setter\n    });\n    if (field.default) {\n      self[field.name] = field.default;\n    }\n    // attach alias\n    if (field.alias) {\n      Object.defineProperty(self, field.alias, {\n        enumerable: false,\n        configurable: true,\n        set: setter,\n        get: getter\n      });\n    }\n  });\n  // if the constuctor is passed data\n  if (data) {\n    if (typeof data === 'string') {\n      data = Buffer.from(ethjsUtil.stripHexPrefix(data), 'hex');\n    }\n    if (Buffer.isBuffer(data)) {\n      data = rlp.decode(data);\n    }\n    if (Array.isArray(data)) {\n      if (data.length > self._fields.length) {\n        throw new Error('wrong number of fields in data');\n      }\n      // make sure all the items are buffers\n      data.forEach(function (d, i) {\n        self[self._fields[i]] = bytes_1.toBuffer(d);\n      });\n    } else if (typeof data === 'object') {\n      var keys_1 = Object.keys(data);\n      fields.forEach(function (field) {\n        if (keys_1.indexOf(field.name) !== -1) self[field.name] = data[field.name];\n        if (keys_1.indexOf(field.alias) !== -1) self[field.alias] = data[field.alias];\n      });\n    } else {\n      throw new Error('invalid data');\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["assert","require","ethjsUtil","exports","self","fields","data","raw","_fields","toJSON","label","obj_1","forEach","field","toString","bytes_1","serialize","rlp","encode","i","push","name","getter","setter","v","allowZero","Buffer","allocUnsafe","allowLess","length","Object","defineProperty","enumerable","configurable","get","set","default","alias","from","stripHexPrefix","isBuffer","decode","Array","isArray","Error","d","keys_1","keys","indexOf"],"sourceRoot":"","sources":["../src/object.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}